<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Smile AI Solution</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        body { background: #000814; font-family: 'Inter', sans-serif; color: white; height: 100dvh; display: flex; flex-direction: column; margin: 0; overflow: hidden; }
        #chat-window { flex: 1; overflow-y: auto; padding: 15px; display: flex; flex-direction: column; gap: 10px; }
        .ai-msg { align-self: flex-start; background: #111; padding: 12px; border-radius: 15px; max-width: 85%; font-size: 0.95rem; border: 1px solid #222; }
        .user-msg { align-self: flex-end; background: #00b4d8; padding: 10px 15px; border-radius: 15px; max-width: 80%; font-size: 0.95rem; font-weight: 500; }
        .bottom-nav { background: #000814; padding: 12px; border-top: 1px solid #1a1a1a; }
        .input-box { background: #0a0a0a; border-radius: 30px; padding: 5px 15px; border: 1px solid #333; display: flex; align-items: center; }
        input { flex: 1; background: transparent; border: none; outline: none; color: white; padding: 10px; font-size: 1rem; }
        #loading { font-size: 11px; color: #00b4d8; margin-left: 15px; display: none; }
    </style>
</head>
<body>
    <header class="p-4 border-b border-white/10 flex justify-between items-center bg-black/40 backdrop-blur-md">
        <div class="text-cyan-400 font-bold text-xl">Smile AI Solution</div>
        <div id="auth-ui">
            <button id="login-btn" class="text-xs border border-cyan-500/50 px-4 py-1.5 rounded-full">Login</button>
            <div id="user-profile" class="hidden flex items-center gap-3">
                <img id="avatar" class="w-8 h-8 rounded-full border border-cyan-400">
                <button id="logout-btn" class="text-[10px] text-red-500 font-bold">EXIT</button>
            </div>
        </div>
    </header>

    <div id="chat-window">
        <div class="ai-msg">Dost, main Smile AI hoon. Batao aaj kya trouble hai?</div>
    </div>

    <div class="bottom-nav">
        <div id="loading">Thinking...</div>
        <div class="input-box">
            <input type="text" id="user-input" placeholder="Likho yahan...">
            <button id="send-btn"><i class="fa-solid fa-paper-plane text-cyan-400 text-xl"></i></button>
        </div>
        <div class="flex justify-around mt-4 pb-2">
            <button id="mic-btn"><i class="fa-solid fa-microphone text-cyan-100 text-2xl"></i></button>
            <button onclick="window.open('https://wa.me/?text=Check this out!')"><i class="fa-solid fa-share-nodes text-green-500 text-2xl"></i></button>
            <button onclick="location.reload()"><i class="fa-solid fa-house text-gray-400 text-2xl"></i></button>
        </div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-app.js";
        import { getAuth, signInWithPopup, GoogleAuthProvider, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.8.0/firebase-auth.js";

        const firebaseConfig = {
            apiKey: "AIzaSyD3FEfP9Htj3ANvIENwzlNIKZRE7qIYFBc",
            authDomain: "smile-finance-ai-2026.firebaseapp.com",
            projectId: "smile-finance-ai-2026",
            storageBucket: "smile-finance-ai-2026.appspot.com",
            messagingSenderId: "325593143394",
            appId: "1:325593143394:web:2b5f3c2404279d4594d93b"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(auth);
        const provider = new GoogleAuthProvider();
        const KEY = "AIzaSyDJzZwjtrqEjeKzCdewT0Ie7UFB3xlz7fA";

        let voiceMode = false;

        onAuthStateChanged(auth, (user) => {
            if (user) {
                document.getElementById('login-btn').classList.add('hidden');
                document.getElementById('user-profile').classList.remove('hidden');
                document.getElementById('avatar').src = user.photoURL;
            }
        });

        document.getElementById('login-btn').onclick = () => signInWithPopup(auth, provider);
        document.getElementById('logout-btn').onclick = () => signOut(auth).then(() => location.reload());

        async function askAI(msg, mic = false) {
            const val = msg || document.getElementById('user-input').value;
            if(!val) return;
            voiceMode = mic;
            const win = document.getElementById('chat-window');
            if(!msg) win.innerHTML += `<div class="user-msg">${val}</div>`;
            document.getElementById('loading').style.display = 'block';
            document.getElementById('user-input').value = "";
            win.scrollTop = win.scrollHeight;

            try {
                const res = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${KEY}`, {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ contents: [{ parts: [{ text: `You are Smile AI. Rules: Hinglish friend. Suggest products via landing page. 99 discount on 5 shares. User: ${val}` }] }] })
                });
                const data = await res.json();
                const reply = data.candidates[0].content.parts[0].text;
                document.getElementById('loading').style.display = 'none';
                win.innerHTML += `<div class="ai-msg">${reply}</div>`;
                win.scrollTop = win.scrollHeight;
            } catch (e) {
                document.getElementById('loading').innerText = "Network slow. Try again!";
            }
        }

        document.getElementById('send-btn').onclick = () => askAI(null, false);
        document.getElementById('user-input').onkeypress = (e) => e.key === 'Enter' && askAI(null, false);

        const Speech = window.SpeechRecognition || window.webkitSpeechRecognition;
        if(Speech) {
            const rec = new Speech(); rec.lang = 'hi-IN';
            document.getElementById('mic-btn').onclick = () => rec.start();
            rec.onresult = (e) => askAI(e.results[0][0].transcript, true);
        }
    </script>
</body>
</html>
